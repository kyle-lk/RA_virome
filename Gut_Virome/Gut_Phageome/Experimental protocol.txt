1. Experimental protocol
Stool samples were collected by participants into sterile stool containers and stored at -80 ℃ within 2 hours. All fecal samples were transported frozen in dry ice to laboratories at Institute Pasteur of Shanghai, and stored at −80 °C until use. 
  500 mg of fecal sample from each patient was homogenized with 1 mL PBS, and the homogenized suspension was centrifuged for 15 min at 12,000 g at 4 ℃. The supernatant was filtered through a 0.45 μm sterile filter (Costar Spin-X centrifuge tube filters, Corning, Lowell, MA), and cell-free nucleic acids in the filtrate were digested by incubation with a cocktail of nucleases including 15 U Turbo DNase (Invitrogen, Carlsbad, CA), 20 U Benzonase (Novagen, Germany), and 20 U RNase I (Promega, Madison, WI) for 2 hours at 37 °C.
    Total nucleic acids (including DNA and RNA) were extracted using QIAamp MiniElute virus kit (Qiagen, Germany), and then amplified by a random-amplification approach (REPLI-g Single Cell WTA kit, Qiagen) for metagenomic analysis. Multiple displacement amplification (MDA), an efficient method to amplify small amounts of DNA samples was used. Briefly, nucleic acids were first reverse-transcribed to complementary DNA (cDNA) using random primers, and then subjected to a ligation reaction to obtain large fragments of DNA according to the manufacturer’s instructions. The obtained DNA was further amplified using MDA with phi29 polymerase for 2 hours. The MDA products were purified using AmPure beads (Qiagen) and quantitated by QuantiFluor®-ST Fluorometer (Promega, Madison, WI) using Quant-iTTM PicoGreenTM dsDNA Assay Kit (Invitrogen). Agarose gel electrophoresis was used to monitor DNA purity and integrity. The amplified products were used for library construction and sequencing. 
    Library construction were used Illumina TruSeq Nano DNA LT Library Preparation Kit. Briefly, a total of 1 μg purified DNA product was randomly fragmented by ultrasonication (Covaris E210, Woburn, MA) followed by end repairing. Then a single ‘A’ nucleotide was added to the 3’ ends of the blunt fragments and multiple indexed pair-end adapters were ligated to the ends of the DNA fragments. The ligation reaction products were purified by agarose gel and selectively enriched by PCR. The library was quantified by QuantiFluor®-ST Fluorometer using Quant-iTTM PicoGreenTM dsDNA Assay Kit and qualified by Agilent 2100 Bioanalyzer. Multiplexed DNA libraries were normalized to 10 nM and pooled in equal volumes, sequenced by Illumina HiSeq X-ten sequencing platform (Illumina, San Diego, CA) with 2 × 150 bp paired-end reads strategy.

2. Bioinformatic analysis
Metagenomic reads were first decontaminated and trimmed by Cutadapt v1.18 and Trimmomatic v0.38 with the following parameters: SLIDINGWINDOW:4:20 MINLEN:50. The remaining reads were mapped to the human reference genome (hg19) by Bowtie2 v2.3.5.1. Unmapped reads were de novo assembled by MEGAHIT assemblies v1.2.9 using the following parameters: –presets meta-large (–k-min 27 –k-max 127 –k-step 10). The contigs assembled from all samples were then pooled together, and low complexity contigs, as well as human and bacterial contigs, were removed by PrinSeq v0.20.4 and Bowtie2 v2.3.5.1. One NR (non-redundant) contig set was created by de-replicating and clustering all contigs longer than 1000 nt at 95% average nucleotide identity (ANI) and 85% coverage using Vsearch v2.10.427, 41. A total of 803,191 contigs were selected for subsequent virus classification and annotation. After a series of filtering conditions， we finally got 1917 curated virus contigs with Checkv assessed >= 50% completeness and more than 150 read counts across all samples.






